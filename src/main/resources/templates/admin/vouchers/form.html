<!DOCTYPE html>
<html
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layouts/admin}"
>
  <head>
    <title th:text="${isEdit} ? 'Sửa voucher' : 'Thêm voucher'">Voucher</title>
  </head>

  <body>
    <div layout:fragment="content">
      <div class="admin-page-header">
        <h1
          class="admin-page-title"
          th:text="${isEdit} ?  'Sửa voucher' : 'Thêm voucher mới'"
        >
          Voucher
        </h1>
        <a th:href="@{/admin/vouchers}" class="btn btn-ghost"
          ><i class="bx bx-arrow-back"></i> Quay lại</a
        >
      </div>

      <div class="admin-form-card" style="max-width: 700px">
        <form
          th:action="${isEdit} ? @{/admin/vouchers/{id}/edit(id=${voucher.id})} : @{/admin/vouchers/create}"
          method="post"
          th:object="${voucherRequest}"
        >
          <input
            type="hidden"
            th:name="${_csrf.parameterName}"
            th:value="${_csrf.token}"
          />

          <div class="admin-form-grid">
            <div class="form-group">
              <label class="form-label"
                >Mã voucher <span class="text-danger">*</span></label
              >
              <input
                type="text"
                th:field="*{code}"
                class="form-control"
                th:classappend="${#fields.hasErrors('code')} ? 'is-invalid' : ''"
                placeholder="VD: SALE50"
                required
                style="text-transform: uppercase"
              />
              <div th:if="${#fields.hasErrors('code')}" class="form-error">
                <i class="bx bx-error"></i> <span th:errors="*{code}"></span>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label"
                >Tên voucher <span class="text-danger">*</span></label
              >
              <input
                type="text"
                th:field="*{name}"
                class="form-control"
                placeholder="VD: Giảm 50% đơn hàng"
                required
              />
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Mô tả</label>
            <textarea
              th:field="*{description}"
              class="form-control"
              rows="2"
              placeholder="Mô tả chi tiết voucher"
            ></textarea>
          </div>

          <div class="admin-form-grid">
            <div class="form-group">
              <label class="form-label"
                >Loại giảm giá <span class="text-danger">*</span></label
              >
              <select
                th:field="*{discountType}"
                class="form-control form-select"
                required
              >
                <option value="PERCENTAGE">Phần trăm (%)</option>
                <option value="FIXED_AMOUNT">Số tiền cố định (VNĐ)</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label"
                >Giá trị giảm <span class="text-danger">*</span></label
              >
              <input
                type="number"
                th:field="*{discountValue}"
                class="form-control"
                min="0"
                required
                placeholder="VD: 50 hoặc 100000"
              />
            </div>
          </div>

          <div class="admin-form-grid">
            <div class="form-group">
              <label class="form-label">Giảm tối đa (VNĐ)</label>
              <input
                type="number"
                th:field="*{maxDiscount}"
                class="form-control"
                min="0"
                placeholder="Để trống nếu không giới hạn"
              />
              <p class="text-muted" style="font-size: 12px">
                Áp dụng cho loại phần trăm
              </p>
            </div>
            <div class="form-group">
              <label class="form-label">Đơn hàng tối thiểu (VNĐ)</label>
              <input
                type="number"
                th:field="*{minOrderAmount}"
                class="form-control"
                min="0"
                placeholder="Để trống nếu không yêu cầu"
              />
            </div>
          </div>

          <div class="admin-form-grid">
            <div class="form-group">
              <label class="form-label"
                >Ngày bắt đầu <span class="text-danger">*</span></label
              >
              <input
                type="datetime-local"
                th:field="*{startDate}"
                class="form-control"
                required
              />
            </div>
            <div class="form-group">
              <label class="form-label"
                >Ngày kết thúc <span class="text-danger">*</span></label
              >
              <input
                type="datetime-local"
                th:field="*{endDate}"
                class="form-control"
                required
              />
            </div>
          </div>

          <div class="admin-form-grid">
            <div class="form-group">
              <label class="form-label">Giới hạn sử dụng</label>
              <input
                type="number"
                th:field="*{usageLimit}"
                class="form-control"
                min="0"
                placeholder="Để trống nếu không giới hạn"
              />
            </div>
            <div class="form-group">
              <label class="form-label">Giới hạn/người dùng</label>
              <input
                type="number"
                th:field="*{usageLimitPerUser}"
                class="form-control"
                min="0"
                value="1"
                placeholder="Mặc định:  1"
              />
            </div>
          </div>

          <div class="form-group">
            <label class="form-check">
              <input
                type="checkbox"
                th:field="*{isActive}"
                class="form-check-input"
              />
              <span class="form-check-label">Kích hoạt voucher</span>
            </label>
          </div>

          <div class="d-flex gap-3">
            <button type="submit" class="btn btn-primary">
              <i class="bx bx-save"></i>
              <span th:text="${isEdit} ? 'Cập nhật' : 'Tạo voucher'">Lưu</span>
            </button>
            <a th:href="@{/admin/vouchers}" class="btn btn-ghost">Hủy</a>
          </div>
        </form>
      </div>
    </div>
  </body>
</html>
